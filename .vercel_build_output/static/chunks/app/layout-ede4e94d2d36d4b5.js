(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},2688:(e,t,a)=>{"use strict";a.d(t,{G:()=>i,c:()=>n});var r=a(5155),o=a(2115);let s=(0,o.createContext)(void 0),n=()=>{let e=(0,o.useContext)(s);if(!e)throw Error("useSidebar must be used within a SidebarProvider");return e},i=e=>{let{children:t}=e,[a,n]=(0,o.useState)(!0),[i,l]=(0,o.useState)(!1),[d,c]=(0,o.useState)(!1),[u,m]=(0,o.useState)(!1),[h,g]=(0,o.useState)(null),[f,S]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let e=()=>{let e=window.innerWidth<768;c(e),e||l(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,r.jsx)(s.Provider,{value:{isExpanded:!d&&a,isMobileOpen:i,isHovered:u,activeItem:h,openSubmenu:f,toggleSidebar:()=>{n(e=>!e)},toggleMobileSidebar:()=>{l(e=>!e)},setIsHovered:m,setActiveItem:g,toggleSubmenu:e=>{S(t=>t===e?null:e)}},children:t})}},2944:(e,t,a)=>{"use strict";a.d(t,{O:()=>c,A:()=>u});var r=a(5155),o=a(2115),s=a(7485);let n=async(e,t)=>{try{console.log("Attempting to authenticate with API:",{email:e,password:"******"});let a=await s.A.post("/auth/login",{email:e,password:t});if(a.data&&a.data.access_token)return localStorage.setItem("authToken",a.data.access_token),{id:a.data.id,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),name:e.split("@")[0],password:"",email:e,phone:"",address:"",role:a.data.role};return console.log("Login response is missing access_token:",a.data),null}catch(e){return console.log("Login API endpoint failed:",e instanceof Error?e.message:e),null}},i=[{id:1,email:"admin@zaraschool.com",password:"admin123",firstName:"Admin",lastName:"User",role:"admin"},{id:2,email:"teacher@zaraschool.com",password:"teacher123",firstName:"Teacher",lastName:"Smith",role:"teacher"},{id:3,email:"student@zaraschool.com",password:"student123",firstName:"Student",lastName:"Jones",role:"student"}],l={admin:"/dashboard/admin",teacher:"/dashboard/teacher",student:"/dashboard/student",default:"/dashboard"},d=(0,o.createContext)(void 0),c=e=>{let{children:t}=e,[a,s]=(0,o.useState)(null),[c,u]=(0,o.useState)(!0),[m,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=localStorage.getItem("user");if(e&&s(JSON.parse(e)),u(!1),!localStorage.getItem("users")){let e=i.map(e=>{let{password:t,...a}=e;return a});localStorage.setItem("users",JSON.stringify(e))}},[]);let g=async(e,t)=>{try{if(u(!0),h(null),!e||!t)throw Error("Email and password are required");let a=i.find(a=>a.email.toLowerCase()===e.toLowerCase()&&a.password===t);if(a){let{password:e,...t}=a,r={...t,name:"".concat(t.firstName," ").concat(t.lastName),role:t.role.toLowerCase()};localStorage.setItem("authToken","mock-token-".concat(Date.now())),s(r),localStorage.setItem("user",JSON.stringify(r)),console.log("Signed in as predefined user:",r);return}try{let a=await n(e,t);if(a){let{password:e,...t}=a,r={id:t.id,email:t.email,name:t.name,role:t.role.toLowerCase(),phone:t.phone,address:t.address};s(r),localStorage.setItem("user",JSON.stringify(r)),console.log("Signed in via API:",r)}else h("Invalid credentials. Please check your email and password.")}catch(e){console.error("API authentication error:",e),h("Authentication service is unavailable. Please try again later or use a predefined account.")}}catch(e){h(e instanceof Error?e.message:"Authentication failed"),console.error("Signin error:",e)}finally{u(!1)}},f=async e=>{try{if(u(!0),h(null),!e.email||!e.password||!e.role)throw Error("Email, password, and role are required");if(i.some(t=>t.email===e.email))throw Error("Email is already in use");let t=JSON.parse(localStorage.getItem("users")||"[]");if(t.some(t=>t.email===e.email))throw Error("Email is already in use");let a={id:parseInt("user"+Date.now()),email:e.email,firstName:e.firstName,lastName:e.lastName,name:"".concat(e.firstName," ").concat(e.lastName),role:e.role};t.push(a),localStorage.setItem("users",JSON.stringify(t)),s(a),localStorage.setItem("user",JSON.stringify(a)),console.log("Signed up as:",a)}catch(e){h(e instanceof Error?e.message:"Registration failed"),console.error("Signup error:",e)}finally{u(!1)}},S=!!a;return(0,r.jsx)(d.Provider,{value:{user:a,signin:g,signup:f,signout:()=>{s(null),localStorage.removeItem("user"),console.log("Signed out")},isAuthenticated:S,isLoading:c,error:m,getRedirectPath:()=>a?l[a.role.toLowerCase()]||l.default:"/signin"},children:t})},u=()=>{let e=(0,o.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6164:(e,t,a)=>{Promise.resolve().then(a.bind(a,6903))},6903:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155);a(347);var o=a(2688),s=a(7049),n=a(2944);function i(e){let{children:t}=e;return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{className:"font-outfit dark:bg-gray-900",children:(0,r.jsx)(n.O,{children:(0,r.jsx)(s.N,{children:(0,r.jsx)(o.G,{children:t})})})})})}},7049:(e,t,a)=>{"use strict";a.d(t,{D:()=>i,N:()=>n});var r=a(5155),o=a(2115);let s=(0,o.createContext)(void 0),n=e=>{let{children:t}=e,[a,n]=(0,o.useState)("light"),[i,l]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{n(localStorage.getItem("theme")||"light"),l(!0)},[]),(0,o.useEffect)(()=>{i&&(localStorage.setItem("theme",a),"dark"===a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))},[a,i]),(0,r.jsx)(s.Provider,{value:{theme:a,toggleTheme:()=>{n(e=>"light"===e?"dark":"light")}},children:t})},i=()=>{let e=(0,o.useContext)(s);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},7485:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});let r=a(3464).A.create({baseURL:"https://zaraschool-05bf2031623e.herokuapp.com",headers:{"Content-Type":"application/json",Accept:"application/json"}});r.interceptors.request.use(e=>{let t=localStorage.getItem("authToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&!window.location.pathname.includes("/signin")&&(localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/signin"),Promise.reject(e)));let o=r}},e=>{var t=t=>e(e.s=t);e.O(0,[7690,3464,8441,1684,7358],()=>t(6164)),_N_E=e.O()}]);